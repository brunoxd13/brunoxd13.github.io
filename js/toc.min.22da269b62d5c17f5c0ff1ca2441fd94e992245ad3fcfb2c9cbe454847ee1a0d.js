document.addEventListener("DOMContentLoaded",()=>{const t=document.querySelector(".sidebar-toc");if(!t)return;const n=t.querySelector("nav");if(!n)return;const e=Array.from(n.querySelectorAll("li"));if(e.length===0)return;const a=Array.from(document.querySelectorAll("h1[id], h2[id], h3[id], h4[id], h5[id], h6[id]"));if(a.length===0)return;const w=t.getAttribute("data-toc-level")||"root",m=w==="root";let o="",s=!1,i=!1;const l=b();function b(){const t={},e=[];return a.forEach(n=>{const o=parseInt(n.tagName[1]),s=n.id;for(;e.length>0&&e[e.length-1].level>=o;)e.pop();e.length>0?t[s]=e[e.length-1].id:t[s]=null,e.push({id:s,level:o})}),t}function v(e){let t=e;for(;l[t];)t=l[t];return t}function f(t){const s=e.find(e=>{const n=e.querySelector("a");return n&&n.getAttribute("href")===`#${t}`});if(s){const e=s.parentElement;if(e&&window.getComputedStyle(e).display!=="none")return t}if(m)return v(t);let n=t;for(;n;){const t=l[n];if(!t)return n;const s=e.find(e=>{const n=e.querySelector("a");return n&&n.getAttribute("href")===`#${t}`});if(s){const e=s.parentElement;if(e&&window.getComputedStyle(e).display!=="none")return t}n=t}return t}function p(){e.forEach((e,t)=>{const n=e.querySelector("a");t===0?(e.style.maxHeight="40px",e.style.opacity="1",n&&n.classList.add("toc-neighbor")):(e.style.maxHeight="0px",e.style.opacity="0",n&&n.classList.add("toc-hidden"))})}p();function g(){const t=window.scrollY,n=window.innerHeight,s=n*.2;let e=null;for(const n of a){const o=n.getBoundingClientRect(),i=o.top+t;if(t+s>=i)e=n;else break}return e?e.id:""}const u=()=>{if(window.scrollY<50)o="";else{const e=g();o=e?f(e):""}r();const e=200;window.scrollY>e&&!i?(i=!0,t.classList.add("is-visible")):window.scrollY<=e&&i&&(i=!1,t.classList.remove("is-visible"))};let d=!1;window.addEventListener("scroll",()=>{d||(window.requestAnimationFrame(()=>{u(),d=!1}),d=!0)},{passive:!0}),n.addEventListener("mouseenter",()=>{s=!0,r()}),n.addEventListener("mouseleave",()=>{s=!1,r()});function h(){return o?e.findIndex(e=>{const t=e.querySelector("a");if(!t)return!1;const n=t.getAttribute("href");return n===`#${o}`}):-1}function j(){const e=n.querySelector(":scope > ul");return e?Array.from(e.querySelectorAll(":scope > li")):[]}const c=j();function y(t){if(s)return!0;const n=h(),o=e[t];if(m){const a=c.includes(o);if(!a)return!1;const i=n>=0?e[n]:null,t=i?c.indexOf(i):-1,s=c.indexOf(o);return t===-1&&s===0||s===t||s===t-1||s===t+1}if(t===n||t===n-1||t===n+1||n===-1&&t===0)return!0;if(n>=0){const o=e[n],s=_(o);if(s&&e[t]===s)return!0}return!1}function _(e){let t=e,n=null;for(;t;){const s=t.parentElement;if(!s||s.tagName!=="UL")break;const e=s.parentElement;if(e&&e.tagName==="NAV")return n;if(e&&e.tagName==="LI")n=e,t=e;else break}return n}function r(){const t=h();e.forEach((e,n)=>{const o=e.querySelector("a");if(!o)return;const i=y(n),a=n===t;if(s||i){const t=e.querySelector("ul");let n="40px";if(t){const e=Array.from(t.querySelectorAll(":scope > li"));n=40+e.length*40+"px"}e.style.maxHeight=n,e.style.opacity="1"}else e.style.maxHeight="0px",e.style.opacity="0";o.classList.remove("toc-active","toc-neighbor","toc-hidden"),s?a?o.classList.add("toc-active"):o.classList.add("toc-neighbor"):a?o.classList.add("toc-active"):i?o.classList.add("toc-neighbor"):o.classList.add("toc-hidden")})}u()})